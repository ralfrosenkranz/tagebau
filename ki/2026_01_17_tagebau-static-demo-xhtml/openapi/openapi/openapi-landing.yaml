openapi: 3.0.3
info:
  title: Tagebau Shop API - Landing
  version: 0.1.0
  description: |
    REST-Schnittstellen fuer Landingpage (Eyecatcher + Topseller) des Demo-Webshops.
    Basierend auf den Java-Modellklassen: Catalog, Category, Product, Pricing, Inventory, ProductMedia/MediaImage.
servers:
  - url: /api

tags:
  - name: Landing
  - name: Categories
  - name: Products

paths:
  /landing:
    get:
      tags: [Landing]
      summary: Landingpage Payload (Hero + Highlights + Topseller)
      operationId: getLanding
      parameters:
        - in: query
          name: topLimit
          description: Anzahl der Top-Produkte.
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 8
      responses:
        '200':
          description: Landingpage Daten
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LandingResponse'

  /categories:
    get:
      tags: [Categories]
      summary: Kategorien-Liste
      operationId: listCategories
      responses:
        '200':
          description: Kategorien
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'

  /products/top:
    get:
      tags: [Products, Landing]
      summary: Topseller/Top-Produkte
      operationId: listTopProducts
      parameters:
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 8
      responses:
        '200':
          description: Top-Produkte
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductCard'

  /products/search:
    get:
      tags: [Products]
      summary: Produktsuche (Landing-Suchfeld)
      operationId: searchProducts
      parameters:
        - in: query
          name: q
          required: true
          schema:
            type: string
            minLength: 1
        - in: query
          name: categoryId
          required: false
          schema:
            type: string
            maxLength: 32
        - in: query
          name: page
          schema:
            type: integer
            minimum: 0
            default: 0
        - in: query
          name: size
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - in: query
          name: sort
          description: Sortierung (z.B. nickname,pricing.priceExorbitant)
          schema:
            type: string
      responses:
        '200':
          description: Trefferseite
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedProductCard'

components:
  schemas:
    Category:
      type: object
      additionalProperties: false
      required: [id, name]
      properties:
        id:
          type: string
          maxLength: 32
        name:
          type: string
          maxLength: 255

    PricingSummary:
      type: object
      additionalProperties: false
      required: [currency, priceExorbitant, listPriceEvenMoreExorbitant]
      properties:
        currency:
          type: string
          minLength: 3
          maxLength: 3
          description: ISO-4217 (aus Pricing.currency)
          example: EUR
        priceExorbitant:
          type: integer
          format: int64
          description: Preis (aus Pricing.priceExorbitant)
        listPriceEvenMoreExorbitant:
          type: integer
          format: int64
          description: Listenpreis (aus Pricing.listPriceEvenMoreExorbitant)
        vatNote:
          type: string
          nullable: true

    InventorySummary:
      type: object
      additionalProperties: false
      required: [stockQty, availability]
      properties:
        stockQty:
          type: integer
          format: int32
          minimum: 0
        availability:
          type: string
          maxLength: 64
          description: Freitext/Enum-String (aus Inventory.availability)

    MediaThumb:
      type: object
      additionalProperties: false
      required: [thumbnailFile]
      properties:
        thumbnailFile:
          type: string
          maxLength: 512
          description: Pfad/URL auf Thumbnail (aus MediaImage.thumbnailFile)

    ProductCard:
      type: object
      additionalProperties: false
      required:
        - id
        - sku
        - categoryId
        - categoryName
        - technicalName
        - nickname
        - condition
        - pricing
        - inventory
      properties:
        id:
          type: string
          maxLength: 32
        sku:
          type: string
          maxLength: 64
        categoryId:
          type: string
          maxLength: 32
        categoryName:
          type: string
          maxLength: 255
        technicalName:
          type: string
          maxLength: 255
        nickname:
          type: string
          maxLength: 255
        condition:
          type: string
          maxLength: 64
          description: Zustand (aus Product.condition)
        shortDescription:
          type: string
          nullable: true
        pricing:
          $ref: '#/components/schemas/PricingSummary'
        inventory:
          $ref: '#/components/schemas/InventorySummary'
        thumbnail:
          $ref: '#/components/schemas/MediaThumb'

    Highlight:
      type: object
      additionalProperties: false
      required: [title, text]
      properties:
        title:
          type: string
          maxLength: 80
        text:
          type: string
          maxLength: 200
        iconKey:
          type: string
          maxLength: 32
          description: Optionaler Key, damit der Client ein Icon waehlen kann.

    Hero:
      type: object
      additionalProperties: false
      required: [kicker, title, text]
      properties:
        kicker:
          type: string
        title:
          type: string
        text:
          type: string
        image:
          type: string
          nullable: true
          description: Optionales Hero-Bild (z.B. statisches Asset)

    LandingResponse:
      type: object
      additionalProperties: false
      required: [hero, highlights, topProducts, categories]
      properties:
        hero:
          $ref: '#/components/schemas/Hero'
        highlights:
          type: array
          items:
            $ref: '#/components/schemas/Highlight'
        topProducts:
          type: array
          items:
            $ref: '#/components/schemas/ProductCard'
        categories:
          type: array
          items:
            $ref: '#/components/schemas/Category'

    PagedProductCard:
      type: object
      additionalProperties: false
      required: [items, page, size, totalItems]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ProductCard'
        page:
          type: integer
          minimum: 0
        size:
          type: integer
          minimum: 1
        totalItems:
          type: integer
          minimum: 0
